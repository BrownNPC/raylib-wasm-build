<textarea id="code" style="width: 100%; margin-bottom: 10px" rows="10">
def init():
  InitWindow(800, 450)

def update():
  BeginDrawing()
  ClearBackground(RAYWHITE)
  DrawText("Congrats! You created your first python window!", 190, 200, 20, LIGHTGRAY)
  DrawFPS(10, 10)
  EndDrawing()
</textarea>
<button id="run">RUN</button>

<script type=module src="https://raylib.surge.sh/raylib.js"></script>
<script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>
<raylib-game>
const InitGame = async (raylib) => {
  const pyodide = await loadPyodide()
  
  for (const r of Object.keys(raylib)) {
    pyodide.globals.set(r, raylib[r])
  }
  
  let code

  function go() {
    code = document.getElementById('code').value
    pyodide.runPython(`${code}\ninit()`)
  }

  const update = () => {
    if (code) {
      pyodide.runPython(`update()`)
    }
    requestAnimationFrame(update)
  }
  update()

  document.getElementById('run').addEventListener('click', go)
  go()
}

const UpdateGame = (ts) => {}
</raylib-game>

